<!DOCTYPE html>
<html>
<head>
    <title>Test Spotify Integration</title>
</head>
<body>
    <h1>Spotify Integration Test</h1>
    <button id="testHealth">Test Health Endpoint</button>
    <button id="testAuthUrl">Test Auth URL Endpoint</button>
    <button id="testCurrentlyPlaying">Test Currently Playing Endpoint</button>
    <pre id="output"></pre>

    <script>
        const projectId = 'wckesgfkusqmeylmdokk';
        const publicAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indja2VzZ2ZrdXNxbWV5bG1kb2trIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzOTIzMTcsImV4cCI6MjA3NTk2ODMxN30.bknyoTYwn1bxMOx9xNeTDP53v8jBXtjZFFv_GXl--Co';
        
        const output = document.getElementById('output');

        async function testEndpoint(name, path) {
            output.textContent += `\n\nTesting ${name}...\n`;
            const url = `https://${projectId}.supabase.co/functions/v1/${path}`;
            output.textContent += `URL: ${url}\n`;
            
            try {
                const response = await fetch(url, {
                    headers: {
                        Authorization: `Bearer ${publicAnonKey}`,
                    },
                });
                
                output.textContent += `Status: ${response.status}\n`;
                const text = await response.text();
                output.textContent += `Response: ${text}\n`;
            } catch (error) {
                output.textContent += `Error: ${error.message}\n`;
            }
        }

        document.getElementById('testHealth').addEventListener('click', () => {
            testEndpoint('Health', 'make-server-db962463/health');
        });

        document.getElementById('testAuthUrl').addEventListener('click', () => {
            testEndpoint('Auth URL', 'make-server-db962463/spotify/auth-url');
        });

        document.getElementById('testCurrentlyPlaying').addEventListener('click', () => {
            testEndpoint('Currently Playing', 'make-server-db962463/spotify/currently-playing');
        });
    </script>
</body>
</html>
